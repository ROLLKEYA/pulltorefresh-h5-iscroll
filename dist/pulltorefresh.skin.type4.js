/**
 * pulltorefresh-h5-iscroll - 一款基于IScroll5的H5下拉刷新实现，包括多种皮肤的实现
 * @version v3.0.0
 * @author 
 */
!function(t){!function(){t.uuid=function(t,o){var i,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),e=[];if(o=o||n.length,t)for(i=0;i<t;i++)e[i]=n[0|Math.random()*o];else{var s;for(e[8]=e[13]=e[18]=e[23]="-",e[14]="4",i=0;i<36;i++)e[i]||(s=0|16*Math.random(),e[i]=n[19==i?3&s|8:s])}return e.join("")},t.noop=function(){},t.extend=function(){var o,i,n,e,s,l,r=arguments[0]||{},a=1,c=arguments.length,u=!1;for("boolean"==typeof r&&(u=r,r=arguments[a]||{},a++),"object"==typeof r||t.isFunction(r)||(r={}),a===c&&(r=this,a--);a<c;a++)if(null!=(o=arguments[a]))for(i in o)n=r[i],e=o[i],r!==e&&(u&&e&&(t.isPlainObject(e)||(s=t.isArray(e)))?(s?(s=!1,l=n&&t.isArray(n)?n:[]):l=n&&t.isPlainObject(n)?n:{},r[i]=t.extend(u,l,e)):void 0!==e&&(r[i]=e));return r},t.isFunction=function(o){return"function"===t.type(o)},t.isPlainObject=function(o){return t.isObject(o)&&!t.isWindow(o)&&Object.getPrototypeOf(o)===Object.prototype},t.isArray=Array.isArray||function(t){return t instanceof Array},t.isWindow=function(t){return null!=t&&t===t.window},t.isObject=function(o){return"object"===t.type(o)},t.type=function(t){return null==t?String(t):o[{}.toString.call(t)]||"object"},t.each=function(t,o,i){if(!t)return this;if("number"==typeof t.length)[].every.call(t,function(t,i){return o.call(t,i,t)!==!1});else for(var n in t)if(i){if(t.hasOwnProperty(n)&&o.call(t[n],n,t[n])===!1)return t}else if(o.call(t[n],n,t[n])===!1)return t;return this};var o={};t.each(["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],function(t,i){o["[object "+i+"]"]=i.toLowerCase()}),function(){function o(o){this.os={},this.os.name="browser";var i=[function(){var t=o.match(/(Android);?[\s\/]+([\d.]+)?/);return t&&(this.os.android=!0,this.os.version=t[2],this.os.isBadAndroid=!/Chrome\/\d/.test(window.navigator.appVersion),this.os.name+="_Android",this.os.name+="_mobile"),this.os.android===!0},function(){var t=o.match(/(iPhone\sOS)\s([\d_]+)/);if(t)this.os.ios=this.os.iphone=!0,this.os.version=t[2].replace(/_/g,"."),this.os.name+="_iphone",this.os.name+="_mobile";else{var i=o.match(/(iPad).*OS\s([\d_]+)/);i&&(this.os.ios=this.os.ipad=!0,this.os.version=i[2].replace(/_/g,"."),this.os.name+="_iOS",this.os.name+="_mobile")}return this.os.ios===!0}];[].every.call(i,function(o){return!o.call(t)})}o.call(t,navigator.userAgent)}(),function(){function o(t){this.os=this.os||{};var o=t.match(/EpointEJS/i);o&&(this.os.ejs=!0,this.os.name+="_ejs");var i=t.match(/DingTalk/i);i&&(this.os.dd=!0,this.os.name+="_dd")}o.call(t,navigator.userAgent)}()}(),function(){var o=!1,i=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,n=function(){};n.extend=function(t){function n(){!o&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;o=!0;var s=new this;o=!1;for(var l in t)s[l]="function"==typeof t[l]&&"function"==typeof e[l]&&i.test(t[l])?function(t,o){return function(){var i=this._super;this._super=e[t];var n=o.apply(this,arguments);return this._super=i,n}}(l,t[l]):t[l];return n.prototype=s,n.prototype.constructor=n,n.extend=this.extend,n},t.Clazz=n}(),function(){var o={generateGlobalObj:function(t,i,n){var e=[].slice.call(arguments);if("string"==typeof e[0]&&(i=e[0],t=window.PullToRefreshTools,n=e[1]),i){var s=i.split("."),l=s.length,t=o.getNameSpaceObj(t,s,l-1);t[s[l-1]]=n}},getNameSpaceObj:function(t,o,i){for(var n=t,e=0;e<i;e++){var s=o[e];n[s]=n[s]||{},n=n[s]}return n}};t.namespace=o.generateGlobalObj}(),"undefined"!=typeof module&&module.exports?module.exports=t:"function"==typeof define&&(define.amd||define.cmd)&&define(function(){return t}),window.PullToRefreshTools=t}({}),function(t,o){var i={down:{height:75,callback:o.noop},up:{offset:100,isFastLoading:!1,callback:o.noop},scroll:{bounceTime:500,successAnimationTime:500,eventPassthrough:!1},element:"#pullrefresh"},n=o.Clazz.extend({init:function(t,n){"object"!=typeof t||t instanceof HTMLElement?this.element=t:(n=t,this.element=n.element),this.element=this.element||i.element,"string"==typeof this.element&&(this.element=document.querySelector(this.element)),this.options=o.extend(!0,{},i,n),this.wrapper=this.element,this.scrollWrap=this.element.children[0],this.scroller=new IScroll(this.element,{probeType:2,tap:!1,mouseWheel:!0,eventPassthrough:this.options.scroll.eventPassthrough}),this._initParams(),this._initPullToRefreshTipsHook&&this._initPullToRefreshTipsHook(this.enablePullDown,this.enablePullUp),this._initEvent(),n.down&&n.down.auto?this.pulldownLoading():n.up&&n.up.auto&&this.pullupLoading()},_initParams:function(){this.enablePullDown=!!this.options.down,this.enablePullUp=!!this.options.up,this.finished=!1,this.offsetY=this.offsetY||0,this.topHeiht=this.options.down&&this.options.down.height?this.options.down.height:0},_initEvent:function(){var t=this;this.scroller.on("scrollStart",function(){t._handleScrollStart(this)}),this.scroller.on("scroll",function(){t._handleScroll(this)}),this.scroller.on("touchEnd",function(){t._handleTouchEnd(this)});var t=this;this.scroller.on("scrollEnd",function(){t._handleScrollEnd(this)}),this.scroller.on("refresh",function(){t.scroller.hasVerticalScroll=!0,0==t.scroller.maxScrollY&&(t.scroller.maxScrollY=-t.offsetY)}),this.refresh()},_handleScrollStart:function(t){this.allowPullDownLoading=!1,this.startY=t.y,this.startX=t.x,this.lastY=t.y;var o=(new Date).getTime();this.startTime=o,this.pulldown=!1},_handleScroll:function(t){if(!this._isFastScroll()){var o=Math.abs(t.x-this.startX),i=Math.abs(t.y-this.startY),n=t.y+this.offsetY;if(this.lastY=t.y,!(Math.abs(t.distX)>Math.abs(t.distY))&&i>5&&i>o&&!this.loading&&!this.allowPullDownSuccessLoading){var e=this.options.down&&this.options.down.height?this.options.down.height:0;this.enablePullDown&&(!this.pulldown&&!this.loading&&t.directionY==-1&&t.y+this.offsetY>=0&&(this.pulldown=!0),t.y+this.offsetY>=e&&t.directionY==-1?this.loading||(this.allowPullDownLoading=!0):t.y+this.offsetY<e&&t.y+this.offsetY>=0&&1===t.directionY&&(this.allowPullDownLoading=!1),this.pulldown&&this._pullingHook&&this._pullingHook(n,e)),this.enablePullUp&&this.options.up&&t.y-this.offsetY-this.options.up.offset<=this.scroller.maxScrollY-e&&1==t.directionY&&this._scrollbottom()}}},_setOffsetY:function(t,o){var i=this;i.offsetY=t||0,i.scroller.minScrollY=-t,i.scroller.scrollTo(0,-i.offsetY),o&&o()},_handleTouchEnd:function(t){var o=this;o.allowPullDownLoading?o.pulldownLoading(void 0,o.options.scroll.bounceTime):o.enablePullDown&&o._pulldownLoaingAnimationEndHook&&o._pulldownLoaingAnimationEndHook()},_handleScrollEnd:function(t){var o=this,i=o.options.down&&o.options.down.height?o.options.down.height:0;o._scrollEndHook&&o._scrollEndHook(),o.enablePullUp&&o.options.up&&!o.loading&&o.options.up.isFastLoading&&t.y-o.offsetY-o.options.up.offset<=o.scroller.maxScrollY-i&&o._scrollbottom()},_isFastScroll:function(){var t=!1,o=(new Date).getTime(),i=o-this.startTime;return t=!(i>100)},_scrollbottom:function(){this.enablePullUp&&!this.finished&&(this.loading||(this.pulldown=!1,this.pullupLoading()))},_endPulldownToRefresh:function(t){var o=this;if(this.options.down&&o.loading){o.allowPullDownLoading=!1,o.loading=!1,o.allowPullDownSuccessLoading=!0;var i;o._pulldownLoaingAnimationSuccessHook&&o._pulldownLoaingAnimationSuccessHook(function(){i&&clearTimeout(i),o.allowPullDownSuccessLoading=!1,o._checkPullDownLoadingEnd()},t),i=setTimeout(function(){i&&clearTimeout(i),o.allowPullDownSuccessLoading=!1,o._checkPullDownLoadingEnd()},o.options.scroll.successAnimationTime)}},_checkPullDownLoadingEnd:function(){var t=this;t.allowPullDownSuccessLoading||(t._pulldownLoaingAnimationEndHook&&t._pulldownLoaingAnimationEndHook(),t.scroller.scrollTo(0,-t.offsetY,t.options.scroll.bounceTime),setTimeout(function(){t.scroller.minScrollY=-t.offsetY,t.scroller.refresh()},t.options.scroll.bounceTime))},_endPullupToRefresh:function(t){var o=this;o.pulldown||(o.loading=!1,o.scroller.refresh(),t&&(o.finished=!0),o._pullupLoaingAnimationSuccessHook&&o._pullupLoaingAnimationSuccessHook(t))},pulldownLoading:function(t,o){var i=this;this.options.down&&(i.loading||("undefined"==typeof t&&(t=this.options.down.height-this.offsetY),i.scroller.minScrollY=i.topHeiht-i.offsetY,setTimeout(function(){i.scroller.scrollTo(0,t,o||0),i._pulldownLoaingAnimationHook&&i._pulldownLoaingAnimationHook(),i.loading=!0;var n=i.options.down.callback;n&&n.call(i)},0)))},pullupLoading:function(t,o,i){if(this.enablePullUp&&this.options.up){if(this.finished&&this.refresh(!0),o=o||0,this.loading)return;this.scroller.scrollTo(o,this.scroller.maxScrollY,i),this.pulldown=!1,this._pullupLoaingAnimationHook&&this._pullupLoaingAnimationHook(!1),this.loading=!0,t=t||this.options.up.callback,t&&t.call(this)}},disablePullupToRefresh:function(){this.enablePullUp=!1,this._disablePullUpHook&&this._disablePullUpHook()},enablePullupToRefresh:function(){this.enablePullUp=!0,this._enablePullUpHook&&this._enablePullUpHook()},refresh:function(t){t&&this.finished&&(this.enablePullupToRefresh(),this.finished=!1),this.scroller.refresh()},resetLoadingState:function(t,o,i){t&&this._endPulldownToRefresh(i),o?this._endPullupToRefresh(!0):this._endPullupToRefresh(!1)},endPullDownToRefresh:function(t){null==t&&(t=!0),this.resetLoadingState(!0,!1,t)},endPullUpToRefresh:function(t,o){null==o&&(o=!0),this.resetLoadingState(!1,t,o)},setSuccessTips:function(t){this.successTips=t}});t.PullToRefresh=n,o.namespace("core",t.PullToRefresh)}({},PullToRefreshTools),function(t,o){var i="hidden",n={down:{height:75,contentdown:"下拉可以刷新",contentover:"释放立即刷新",contentrefresh:"正在刷新",contentrefreshsuccess:"刷新成功",contentrefresherror:"刷新失败",isSuccessTips:!0,callback:o.noop},up:{auto:!1,offset:100,contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"没有更多数据了",callback:o.noop},scroll:{bounceTime:500,successAnimationTime:500},element:"#pullrefresh"},e=o.core.extend({_initPullToRefreshTipsHook:function(t,o){this._initPocket(),this._checkHidden(t,o)},_checkHidden:function(t,o){o||this.bottomPocket&&this.bottomPocket.classList.add(i),t||this.topPocket&&this.topPocket.classList.add(i)},_pullingHook:function(t,o){if(t>=o){this._setCaption(!0,this.options.down.contentover);var i=t-o-10;i>39?i=39:i<0&&(i=0),this.topcaption.style.webkitTransform="translate(0,"+1.6*i+"px)",this.topcaption.style.transform="translate(0,"+1.6*i+"px)"}else t<o&&(this.topcaption.style.opacity=t/o,this.piecontainer.style.transform="translate(0,"+.3*t+"px)",this.piecontainer.style.webkitTransform="translate(0,"+.3*t+"px)",this._setCaption(!0,this.options.down.contentdown));this.pieAnimationUtilObj.setPercent(t,75,10)},_pulldownLoaingAnimationHook:function(){var t=this;this.pieAnimationUtilObj.refresh(function(){t.topcaption.style.opacity=1,t.topcaption.style.transform="translate(0,0px)",t.topcaption.style.webkitTransform="translate(0,0px)",t.topcaption.style.transitionDuration="300ms",t.topcaption.style.webkitTransitionDuration="300ms",t.topcaption.style.transitionTimingFunction="ease-in",t.topcaption.style.webkitTransitionTimingFunction="ease-in"}),this._setCaption(!0,this.options.down.contentrefresh)},_pulldownLoaingAnimationSuccessHook:function(t,o){this.options.down.isSuccessTips?(o?this.pieAnimationUtilObj.success():this.pieAnimationUtilObj.error(),this._setCaption(!0,o?this.options.down.contentrefreshsuccess:this.options.down.contentrefresherror)):t()},_pulldownLoaingAnimationEndHook:function(){var t=this;this.pieAnimationUtilObj.end(function(){t.topcaption.style.opacity=0,t.topcaption.style.webkitTransitionDuration="0ms",t.topcaption.style.transitionDuration="0ms"}),this._setCaption(!0,this.options.down.contentdown,!0)},_pullupLoaingAnimationHook:function(t){this._setCaption(!1,this.options.up.contentrefresh)},_pullupLoaingAnimationSuccessHook:function(t){t?this._setCaption(!1,this.options.up.contentnomore):this._setCaption(!1,this.options.up.contentdown)},_disablePullUpHook:function(){this.bottomPocket.className="pull-bottom-pocket "+i},_enablePullUpHook:function(){this.bottomPocket.classList.remove(i),this._setCaption(!1,this.options.up.contentdown)},_createTopPocket:function(){var t=document.createElement("div");return t.style.visibility="hidden",t.className="pull-top-pocket",t.innerHTML='<div class="pull-loading-icon"><div class="pie-anim-container"><div class="pie"><div class="anim-pie"></div><div class="left-pie"></div></div><div class="fresh-progress"><div class="progress-arrow"></div></div><div class="success-tips"><div class="arrow-left"></div><div class="arrow-right"></div></div><div class="error-tips"><span class="txt left">×</span><span class="txt right">×</span><div class="moon"></div></div></div></div><div class="pull-caption">'+this.options.down.contentdown+"</div>",t},_createBottomPocket:function(){var t=document.createElement("div");return t.style.visibility="hidden",t.className="pull-bottom-pocket",t.innerHTML='<div class="pull-block"><div class="pull-loading-icon"></div><div class="pull-caption">'+this.options.up.contentdown+"</div></div>",t},_initPocket:function(){var t=this;this.wrapper.classList.add("pulltorefresh-type4");var o=this.options;o.down&&o.down.hasOwnProperty("callback")&&(this.topPocket||(this.topPocket=this._createTopPocket(),this.wrapper.insertBefore(this.topPocket,this.wrapper.firstChild)),this.piecontainer=this.element.querySelector(".pie-anim-container"),this.topcaption=this.element.querySelector(".pull-caption"),console.log(this.element.id+","+this.piecontainer+","+this.topcaption),t.pieAnimationUtilObj=t.pieAnimationUtil(),t.pieAnimationUtilObj.init({elem:this.piecontainer})),o.up&&o.up.hasOwnProperty("callback")&&(this.bottomPocket||(this.bottomPocket=this._createBottomPocket(),this.scrollWrap.appendChild(this.bottomPocket)))},_setCaption:function(t,o,i){if(!this.loading){var n;n=t?this.topPocket:this.bottomPocket;var e=n.querySelector(".pull-caption"),s=this.options,l=this;n&&(i?setTimeout(function(){n.className="pull-top-pocket ",e.innerHTML=s.down.contentdown},100):o!==this.lastTitle&&(n.style.visibility="visible",e.innerHTML=o,t?o===s.down.contentrefresh?n.className="pull-top-pocket loading":o===s.down.contentover?n.className="pull-top-pocket flip":o===s.down.contentdown?n.className="pull-top-pocket ":o===s.down.contentrefreshsuccess?(e.innerHTML=l.successTips||o,n.className="pull-top-pocket success"):o===s.down.contentrefresherror&&(n.className="pull-top-pocket error"):o===s.up.contentrefresh?(n.classList.remove("nomore"),n.classList.add("loading")):(n.classList.remove("loading"),o===s.up.contentnomore?n.classList.add("nomore"):n.classList.remove("nomore")),this.lastTitle=o))}},pieAnimationUtil:function(){function t(t,o,i,n){if(t)for(var e,s=["t","webkitT","MozT","msT","OT"],l=0,r=s.length;l<r;l++)if(e=s[l]+"ransform",e in w){var a=s[l].substr(0,s[l].length-1)+o.charAt(0).toUpperCase()+o.substr(1);n?t.style[a]+=i:t.style[a]=i}}function o(o){t(l,"animation","none"),l.style.zIndex=10,t(r,"animation","none"),r.style.backgroundColor=g,t(r,"borderBottomLeftRadius","50%"),t(r,"borderBottomRightRadius","50%"),t(r,"transform","scale(1,1)"),t(r,"transformOriginY","50%"),t(r,"transitionDuration","300ms"),t(r,"transitionTimingFunction","ease-in"),c.style.opacity=1,t(c,"transform","scale(1,1)"),t(c,"transitionDuration","300ms"),t(c,"transitionTimingFunction","ease-in"),t(c,"animation","progressrotate 700ms ease-in-out  400ms infinite"),u.style.opacity=0,t(u,"transitionDuration","0ms"),h.style.opacity=0,t(h,"transitionDuration","0ms"),f=null,o&&o()}function i(o){c.style.opacity=0,u.style.opacity=1,t(u,"transitionDuration","400ms"),t(u,"transitionTimingFunction","ease-in"),f=null}function n(){c.style.opacity=0,h.style.opacity=1,t(h,"transitionTimingFunction","ease-in"),t(h,"transitionDuration","400ms"),f=null}function e(o){c.style.opacity=0,t(c,"transitionDuration","0ms"),t(c,"animation","none"),u.style.opacity=0,t(u,"transitionDuration","0ms"),h.style.opacity=0,t(h,"transitionDuration","0ms"),t(r,"transform","scale(0,0)"),t(r,"transformOriginY","50%"),t(r,"transitionDuration","300ms"),a.style.background=m,t(r,"animation","piebackground 0ms ease-out 150ms"),t(r,"animationFillMode","forwards"),t(l,"animation","pieanimaindex 300ms ease-out"),t(l,"animationFillMode","forwards"),f=null,o&&o()}function s(o){o=o||{},m=o.bgColor||"currentColor",g=o.showColor||"#d00324";var i=o.elem;if(!i)throw new Error("错误，必须有一个elem对象");"string"==typeof i&&(i=document.querySelector(i)),l=i.querySelector(".anim-pie"),r=i.querySelector(".pie"),a=i.querySelector(".left-pie"),c=i.querySelector(".fresh-progress"),u=i.querySelector(".success-tips"),h=i.querySelector(".error-tips"),p=r.offsetWidth,d=r.offsetHeight,setTimeout(function(){p=r.offsetWidth,d=r.offsetHeight},0),t(r,"transform","scale(0,0)")}var l,r,a,c,u,h,p,d,f,m,g,w=document.createElement("div").style,y=function(o,i,n){n=n||0;var e=o/i*100;e>=50&&f<50?(r.style.backgroundColor=g,l.style.zIndex=10):e<50&&(f>=50||!f)&&(r.style.backgroundColor=m,l.style.zIndex=-1),e>=100&&f<100?a.style.background=g:e<100&&(f>=100||!f)&&(a.style.background=m);var s=e/100*360;if(f||(t(l,"animation","none"),t(l,"transitionDuration","0ms"),t(r,"animation","none"),t(r,"transitionDuration","0ms"),t(r,"borderRadius","50%")),t(l,"transform","rotate("+(s>360?360:s)+"deg)"),o<=i)c.style.opacity=0,t(r,"transform","scale("+e/100+","+e/100+")"),t(r,"transformOriginY","50%");else if(t(c,"transform","rotateZ("+s+"deg)"),c.style.opacity=(o-i)/10,o<=i+n);else{var u=o-i-n,h=(p-.1*u)/p,w=(d+1.6*u)/d;w>2.5&&(w=2.5),h<.9&&(h=.9),t(c,"transform"," scale("+(1-.002*u)+","+(1-.002*u)+")",!0),t(r,"borderBottomLeftRadius",50+.1*u+"%"),t(r,"borderBottomRightRadius",50+.1*u+"%"),t(r,"transform","scale("+h+","+w+")"),t(r,"transformOriginY","0%")}f=e};return{init:s,setPercent:y,refresh:o,success:i,error:n,end:e}}});t.initPullToRefresh=function(t,i){return"string"==typeof t||t instanceof HTMLElement||(i=t,t=i.element),i=o.extend(!0,{},n,i),new e(t,i)},t.init=t.initPullToRefresh,o.namespace("skin.type4",t)}({},PullToRefreshTools);