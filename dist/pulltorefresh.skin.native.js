/**
 * pulltorefresh-h5-iscroll - 一款基于IScroll5的H5下拉刷新实现，包括多种皮肤的实现
 * @version v3.0.0
 * @author 
 */
!function(o){!function(){o.uuid=function(o,n){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=[];if(n=n||e.length,o)for(t=0;t<o;t++)i[t]=e[0|Math.random()*n];else{var l;for(i[8]=i[13]=i[18]=i[23]="-",i[14]="4",t=0;t<36;t++)i[t]||(l=0|16*Math.random(),i[t]=e[19==t?3&l|8:l])}return i.join("")},o.noop=function(){},o.extend=function(){var n,t,e,i,l,s,r=arguments[0]||{},u=1,a=arguments.length,c=!1;for("boolean"==typeof r&&(c=r,r=arguments[u]||{},u++),"object"==typeof r||o.isFunction(r)||(r={}),u===a&&(r=this,u--);u<a;u++)if(null!=(n=arguments[u]))for(t in n)e=r[t],i=n[t],r!==i&&(c&&i&&(o.isPlainObject(i)||(l=o.isArray(i)))?(l?(l=!1,s=e&&o.isArray(e)?e:[]):s=e&&o.isPlainObject(e)?e:{},r[t]=o.extend(c,s,i)):void 0!==i&&(r[t]=i));return r},o.isFunction=function(n){return"function"===o.type(n)},o.isPlainObject=function(n){return o.isObject(n)&&!o.isWindow(n)&&Object.getPrototypeOf(n)===Object.prototype},o.isArray=Array.isArray||function(o){return o instanceof Array},o.isWindow=function(o){return null!=o&&o===o.window},o.isObject=function(n){return"object"===o.type(n)},o.type=function(o){return null==o?String(o):n[{}.toString.call(o)]||"object"},o.each=function(o,n,t){if(!o)return this;if("number"==typeof o.length)[].every.call(o,function(o,t){return n.call(o,t,o)!==!1});else for(var e in o)if(t){if(o.hasOwnProperty(e)&&n.call(o[e],e,o[e])===!1)return o}else if(n.call(o[e],e,o[e])===!1)return o;return this};var n={};o.each(["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],function(o,t){n["[object "+t+"]"]=t.toLowerCase()}),function(){function n(n){this.os={},this.os.name="browser";var t=[function(){var o=n.match(/(Android);?[\s\/]+([\d.]+)?/);return o&&(this.os.android=!0,this.os.version=o[2],this.os.isBadAndroid=!/Chrome\/\d/.test(window.navigator.appVersion),this.os.name+="_Android",this.os.name+="_mobile"),this.os.android===!0},function(){var o=n.match(/(iPhone\sOS)\s([\d_]+)/);if(o)this.os.ios=this.os.iphone=!0,this.os.version=o[2].replace(/_/g,"."),this.os.name+="_iphone",this.os.name+="_mobile";else{var t=n.match(/(iPad).*OS\s([\d_]+)/);t&&(this.os.ios=this.os.ipad=!0,this.os.version=t[2].replace(/_/g,"."),this.os.name+="_iOS",this.os.name+="_mobile")}return this.os.ios===!0}];[].every.call(t,function(n){return!n.call(o)})}n.call(o,navigator.userAgent)}(),function(){function n(o){this.os=this.os||{};var n=o.match(/EpointEJS/i);n&&(this.os.ejs=!0,this.os.name+="_ejs");var t=o.match(/DingTalk/i);t&&(this.os.dd=!0,this.os.name+="_dd")}n.call(o,navigator.userAgent)}()}(),function(){var n=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,e=function(){};e.extend=function(o){function e(){!n&&this.init&&this.init.apply(this,arguments)}var i=this.prototype;n=!0;var l=new this;n=!1;for(var s in o)l[s]="function"==typeof o[s]&&"function"==typeof i[s]&&t.test(o[s])?function(o,n){return function(){var t=this._super;this._super=i[o];var e=n.apply(this,arguments);return this._super=t,e}}(s,o[s]):o[s];return e.prototype=l,e.prototype.constructor=e,e.extend=this.extend,e},o.Clazz=e}(),function(){var n={generateGlobalObj:function(o,t,e){var i=[].slice.call(arguments);if("string"==typeof i[0]&&(t=i[0],o=window.PullToRefreshTools,e=i[1]),t){var l=t.split("."),s=l.length,o=n.getNameSpaceObj(o,l,s-1);o[l[s-1]]=e}},getNameSpaceObj:function(o,n,t){for(var e=o,i=0;i<t;i++){var l=n[i];e[l]=e[l]||{},e=e[l]}return e}};o.namespace=n.generateGlobalObj}(),"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&(define.amd||define.cmd)&&define(function(){return o}),window.PullToRefreshTools=o}({}),function(o,n){var t={down:{height:75,callback:n.noop},up:{offset:100,isFastLoading:!1,callback:n.noop},scroll:{bounceTime:500,successAnimationTime:500,eventPassthrough:!1},element:"#pullrefresh"},e=n.Clazz.extend({init:function(o,e){"object"!=typeof o||o instanceof HTMLElement?this.element=o:(e=o,this.element=e.element),this.element=this.element||t.element,"string"==typeof this.element&&(this.element=document.querySelector(this.element)),this.options=n.extend(!0,{},t,e),this.wrapper=this.element,this.scrollWrap=this.element.children[0],this.scroller=new IScroll(this.element,{probeType:2,tap:!1,mouseWheel:!0,eventPassthrough:this.options.scroll.eventPassthrough}),this._initParams(),this._initPullToRefreshTipsHook&&this._initPullToRefreshTipsHook(this.enablePullDown,this.enablePullUp),this._initEvent(),e.down&&e.down.auto?this.pulldownLoading():e.up&&e.up.auto&&this.pullupLoading()},_initParams:function(){this.enablePullDown=!!this.options.down,this.enablePullUp=!!this.options.up,this.finished=!1,this.offsetY=this.offsetY||0,this.topHeiht=this.options.down&&this.options.down.height?this.options.down.height:0},_initEvent:function(){var o=this;this.scroller.on("scrollStart",function(){o._handleScrollStart(this)}),this.scroller.on("scroll",function(){o._handleScroll(this)}),this.scroller.on("touchEnd",function(){o._handleTouchEnd(this)});var o=this;this.scroller.on("scrollEnd",function(){o._handleScrollEnd(this)}),this.scroller.on("refresh",function(){o.scroller.hasVerticalScroll=!0,0==o.scroller.maxScrollY&&(o.scroller.maxScrollY=-o.offsetY)}),this.refresh()},_handleScrollStart:function(o){this.allowPullDownLoading=!1,this.startY=o.y,this.startX=o.x,this.lastY=o.y;var n=(new Date).getTime();this.startTime=n,this.pulldown=!1},_handleScroll:function(o){if(!this._isFastScroll()){var n=Math.abs(o.x-this.startX),t=Math.abs(o.y-this.startY),e=o.y+this.offsetY;if(this.lastY=o.y,!(Math.abs(o.distX)>Math.abs(o.distY))&&t>5&&t>n&&!this.loading&&!this.allowPullDownSuccessLoading){var i=this.options.down&&this.options.down.height?this.options.down.height:0;this.enablePullDown&&(!this.pulldown&&!this.loading&&o.directionY==-1&&o.y+this.offsetY>=0&&(this.pulldown=!0),o.y+this.offsetY>=i&&o.directionY==-1?this.loading||(this.allowPullDownLoading=!0):o.y+this.offsetY<i&&o.y+this.offsetY>=0&&1===o.directionY&&(this.allowPullDownLoading=!1),this.pulldown&&this._pullingHook&&this._pullingHook(e,i)),this.enablePullUp&&this.options.up&&o.y-this.offsetY-this.options.up.offset<=this.scroller.maxScrollY-i&&1==o.directionY&&this._scrollbottom()}}},_setOffsetY:function(o,n){var t=this;t.offsetY=o||0,t.scroller.minScrollY=-o,t.scroller.scrollTo(0,-t.offsetY),n&&n()},_handleTouchEnd:function(o){var n=this;n.allowPullDownLoading?n.pulldownLoading(void 0,n.options.scroll.bounceTime):n.enablePullDown&&n._pulldownLoaingAnimationEndHook&&n._pulldownLoaingAnimationEndHook()},_handleScrollEnd:function(o){var n=this,t=n.options.down&&n.options.down.height?n.options.down.height:0;n._scrollEndHook&&n._scrollEndHook(),n.enablePullUp&&n.options.up&&!n.loading&&n.options.up.isFastLoading&&o.y-n.offsetY-n.options.up.offset<=n.scroller.maxScrollY-t&&n._scrollbottom()},_isFastScroll:function(){var o=!1,n=(new Date).getTime(),t=n-this.startTime;return o=!(t>100)},_scrollbottom:function(){this.enablePullUp&&!this.finished&&(this.loading||(this.pulldown=!1,this.pullupLoading()))},_endPulldownToRefresh:function(o){var n=this;if(this.options.down&&n.loading){n.allowPullDownLoading=!1,n.loading=!1,n.allowPullDownSuccessLoading=!0;var t;n._pulldownLoaingAnimationSuccessHook&&n._pulldownLoaingAnimationSuccessHook(function(){t&&clearTimeout(t),n.allowPullDownSuccessLoading=!1,n._checkPullDownLoadingEnd()},o),t=setTimeout(function(){t&&clearTimeout(t),n.allowPullDownSuccessLoading=!1,n._checkPullDownLoadingEnd()},n.options.scroll.successAnimationTime)}},_checkPullDownLoadingEnd:function(){var o=this;o.allowPullDownSuccessLoading||(o._pulldownLoaingAnimationEndHook&&o._pulldownLoaingAnimationEndHook(),o.scroller.scrollTo(0,-o.offsetY,o.options.scroll.bounceTime),setTimeout(function(){o.scroller.minScrollY=-o.offsetY,o.scroller.refresh()},o.options.scroll.bounceTime))},_endPullupToRefresh:function(o){var n=this;n.pulldown||(n.loading=!1,n.scroller.refresh(),o&&(n.finished=!0),n._pullupLoaingAnimationSuccessHook&&n._pullupLoaingAnimationSuccessHook(o))},pulldownLoading:function(o,n){var t=this;this.options.down&&(t.loading||("undefined"==typeof o&&(o=this.options.down.height-this.offsetY),t.scroller.minScrollY=t.topHeiht-t.offsetY,setTimeout(function(){t.scroller.scrollTo(0,o,n||0),t._pulldownLoaingAnimationHook&&t._pulldownLoaingAnimationHook(),t.loading=!0;var e=t.options.down.callback;e&&e.call(t)},0)))},pullupLoading:function(o,n,t){if(this.enablePullUp&&this.options.up){if(this.finished&&this.refresh(!0),n=n||0,this.loading)return;this.scroller.scrollTo(n,this.scroller.maxScrollY,t),this.pulldown=!1,this._pullupLoaingAnimationHook&&this._pullupLoaingAnimationHook(!1),this.loading=!0,o=o||this.options.up.callback,o&&o.call(this)}},disablePullupToRefresh:function(){this.enablePullUp=!1,this._disablePullUpHook&&this._disablePullUpHook()},enablePullupToRefresh:function(){this.enablePullUp=!0,this._enablePullUpHook&&this._enablePullUpHook()},refresh:function(o){o&&this.finished&&(this.enablePullupToRefresh(),this.finished=!1),this.scroller.refresh()},resetLoadingState:function(o,n,t){o&&this._endPulldownToRefresh(t),n?this._endPullupToRefresh(!0):this._endPullupToRefresh(!1)},endPullDownToRefresh:function(o){null==o&&(o=!0),this.resetLoadingState(!0,!1,o)},endPullUpToRefresh:function(o,n){null==n&&(n=!0),this.resetLoadingState(!1,o,n)},setSuccessTips:function(o){this.successTips=o}});o.PullToRefresh=e,n.namespace("core",o.PullToRefresh)}({},PullToRefreshTools),function(o,n){function t(o){if("string"==typeof o&&(o=document.querySelector(o)),n.os.ejs||n.os.dd){var t=o;t.classList.remove("mui-scroll-wrapper");var e=t.querySelector(".mui-scroll");e&&e.classList.remove("mui-scroll")}}function e(o){if(null==o||"string"!=typeof o)return null;var n,t=document.createElement("div"),e=document.createDocumentFragment();for(t.innerHTML=o;n=t.firstChild;)e.appendChild(n);return e}function i(){var o=0;return o="CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight}function l(){var o=0,n=0,t=0;return document.body&&(n=document.body.scrollTop||0),document.documentElement&&(t=document.documentElement.scrollTop||0),o=n>t?n:t}function s(){var o=0,n=0,t=0;return document.body&&(n=document.body.scrollHeight),document.documentElement&&(t=document.documentElement.scrollHeight),o=n-t>0?n:t}function r(o,t){var e=this;e.loadingUp=!1,e.finished=!1,e.options=t,"string"==typeof o&&(o=document.querySelector(o)),e.elem=o,e.elem.classList.add("pulltorefresh-native-type"),u(),e.options.down&&(n.os.dd?dd.ui.pullToRefresh.enable({onSuccess:function(){e.options.down.callback&&e.options.down.callback()},onFail:function(){dd.ui.pullToRefresh.stop()}}):ejs.nativeUI.pullToRefresh.enable(function(){e.options.down.callback&&e.options.down.callback()}))}function u(){var o=0,n=0,t=0,e=document.body,r=h?"touchstart":"mousedown";e.addEventListener(r,function(i){var l;l=h?i.touches[0]:i,o=Number(l.pageX),n=Number(l.pageY),t=e.scrollTop,d=!0});var u=h?"touchend":"mouseup";e.addEventListener(u,function(o){d=!1,p=!1});var f=h?"touchmove":"mousemove";e.addEventListener(f,function(o){var i;i=h?o.touches[0]:o;var l=(Number(i.pageX),Number(i.pageY));d&&(l-n>30&&0==e.scrollTop&&(p||(console.log("PullDown"),p=!0)),n-l>100&&t==e.scrollTop&&(c.loadingUp||c.finished||c.options.up&&(a(!0),c.options.up.callback&&c.options.up.callback())))});var m=function(){var o=l();document.getElementById("sliderSegmentedControl");o+i()===s()&&(c.loadingUp||c.finished||c.options.up&&(a(!0),c.options.up.callback&&c.options.up.callback()))};document.onscroll=m}function a(o){var n=c.elem;if(n)if(o){if(!c.loadingUp){var t=c.options.up.contentrefresh||"正在加载...";m=m.replace("{{contentrefresh}}",t),n.appendChild(e(m)),c.loadingUp=!0}}else if(c.loadingUp){var i=n.querySelector(".mui-pull-bottom-tips");i&&i.parentNode.removeChild(i),c.loadingUp=!1}}var c,h="ontouchend"in document,d=!1,p=!1,f={down:{callback:n.noop},up:{auto:!1,show:!0,contentrefresh:"正在加载...",callback:n.noop},element:"#pullrefresh"},m='<div class="mui-pull-bottom-tips mui-pull-bottom-tips2"><i class="mui-spinner"></i><span class="mui-pull-loading">{{contentrefresh}}</span></div>';r.prototype.pullupLoading=function(){c.options.up&&(a(!0),c.options.up.callback&&c.options.up.callback())},r.prototype.endPullUpToRefresh=function(o){o&&(this.finished=!0),c.options.up&&a(!1)},r.prototype.endPullDownToRefresh=function(){n.os.dd?dd.ui.pullToRefresh.stop():n.os.ejs&&ejs.nativeUI.pullToRefresh.stop()},r.prototype.refresh=function(o){this.finished=!1},o.initPullToRefresh=function(o,e){if(c)return c;e=n.extend(!0,{},f,e);var i;return"object"!=typeof o?i=o:(e=o,i=e.element),i=i||f.element,"string"==typeof i&&(i=document.querySelector(i)),i?(t(i||"#pullrefresh"),c=new r(i,e),e.up&&e.up.auto&&c.pullupLoading(),c):(console.error("错误,下拉刷新容器为空!"),null)},o.init=o.initPullToRefresh,n.namespace("skin.natives",o)}({},PullToRefreshTools);